// This file is auto-generated by @hey-api/openapi-ts

import { z } from 'zod';

export const zItemType = z.enum(['file', 'folder']);

export const zSyncStatus = z.enum([
    'idle',
    'running',
    'done',
    'error',
    'cancelled',
    'interrupted'
]);

export const zSyncMode = z.enum([
    'auto',
    'full',
    'incremental'
]);

export const zErrorCode = z.enum([
    'UNAUTHORIZED',
    'BAD_REQUEST',
    'NOT_FOUND',
    'CONFLICT',
    'RATE_LIMITED',
    'INTERNAL_ERROR'
]);

export const zIndexDocument = z.object({
    doc_id: z.string(),
    source_id: z.number().int(),
    type: zItemType,
    name: z.string(),
    path_text: z.string(),
    parent_id: z.number().int(),
    modified_at: z.number().int(),
    created_at: z.number().int(),
    size: z.number().int(),
    sha1: z.string(),
    in_trash: z.boolean(),
    is_deleted: z.boolean(),
    highlighted_name: z.string().optional()
});

export const zQueryResult = z.object({
    items: z.array(zIndexDocument),
    total: z.number().int()
});

export const zCrawlStats = z.object({
    foldersVisited: z.number().int(),
    filesIndexed: z.number().int(),
    filesDiscovered: z.number().int(),
    skippedFiles: z.number().int(),
    pagesFetched: z.number().int(),
    failedRequests: z.number().int(),
    startedAt: z.number().int(),
    endedAt: z.number().int()
});

export const zRootSyncProgress = z.object({
    rootFolderId: z.number().int(),
    status: z.string(),
    estimatedTotalDocs: z.union([
        z.number().int(),
        z.null()
    ]).optional(),
    stats: zCrawlStats,
    updatedAt: z.number().int()
});

export const zIncrementalSyncStats = z.object({
    changesFetched: z.number().int(),
    upserted: z.number().int(),
    deleted: z.number().int(),
    skippedUpserts: z.number().int(),
    skippedDeletes: z.number().int(),
    cursorBefore: z.number().int(),
    cursorAfter: z.number().int()
});

export const zSyncVerification = z.object({
    meiliDocCount: z.number().int(),
    crawledDocCount: z.number().int(),
    discoveredDocCount: z.number().int(),
    skippedCount: z.number().int(),
    verified: z.boolean(),
    warnings: z.array(z.string()).optional()
});

export const zSyncProgressState = z.object({
    status: zSyncStatus,
    mode: zSyncMode.optional(),
    startedAt: z.number().int(),
    updatedAt: z.number().int(),
    roots: z.array(z.number().int()),
    rootNames: z.record(z.string()).optional(),
    completedRoots: z.array(z.number().int()),
    activeRoot: z.union([
        z.number().int(),
        z.null()
    ]).optional(),
    aggregateStats: zCrawlStats,
    rootProgress: z.record(zRootSyncProgress),
    incrementalStats: z.union([
        zIncrementalSyncStats,
        z.null()
    ]).optional(),
    lastError: z.string().optional(),
    verification: z.union([
        zSyncVerification,
        z.null()
    ]).optional()
});

export const zSyncStartRequest = z.object({
    mode: zSyncMode.optional(),
    root_folder_ids: z.array(z.number().int()).optional(),
    include_departments: z.union([
        z.boolean(),
        z.null()
    ]).optional(),
    department_ids: z.array(z.number().int()).optional(),
    resume_progress: z.union([
        z.boolean(),
        z.null()
    ]).optional(),
    root_workers: z.number().int().optional(),
    progress_every: z.number().int().optional(),
    checkpoint_template: z.string().optional(),
    window_overlap_ms: z.number().int().optional(),
    incremental_query: z.string().optional()
});

export const zTokenRequest = z.object({
    token: z.string().optional(),
    client_id: z.string().optional(),
    client_secret: z.string().optional(),
    sub_id: z.number().int().optional(),
    sub_type: z.string().optional(),
    oauth_host: z.string().optional()
});

export const zRemoteSearchItem = z.object({
    id: z.number().int(),
    name: z.string(),
    type: z.string()
});

export const zRemoteSearchResponse = z.object({
    files: z.array(zRemoteSearchItem),
    folders: z.array(zRemoteSearchItem),
    total_count: z.number().int(),
    page_id: z.number().int(),
    page_capacity: z.number().int(),
    page_count: z.number().int()
});

export const zErrorResponse = z.object({
    code: zErrorCode,
    message: z.string(),
    request_id: z.string().optional()
});

export const zHealthResponse = z.object({
    status: z.string(),
    running_sync: z.boolean()
});

export const zReadyResponse = z.object({
    status: z.enum(['ready', 'not_ready']),
    meili: z.string().optional()
});

export const zDownloadUrlResponse = z.object({
    file_id: z.number().int(),
    download_url: z.string().url()
});

export const zMessageResponse = z.object({
    message: z.string()
});

/**
 * Search query string (alias `q` also accepted).
 */
export const zQueryParam = z.string().min(1);

/**
 * Page number (1-based).
 */
export const zPageParam = z.number().int().gte(1).default(1);

/**
 * Number of results per page.
 */
export const zPageSizeParam = z.number().int().gte(1).default(20);

/**
 * Numeric file ID.
 */
export const zFileIdParam = z.number().int().gte(1);

/**
 * Download URL validity period in seconds.
 */
export const zValidPeriodParam = z.number().int();

export const zHealthData = z.object({
    body: z.never().optional(),
    path: z.never().optional(),
    query: z.never().optional()
});

/**
 * Service is alive.
 */
export const zHealthResponse2 = zHealthResponse;

export const zReadyzData = z.object({
    body: z.never().optional(),
    path: z.never().optional(),
    query: z.never().optional()
});

/**
 * Service is ready.
 */
export const zReadyzResponse = zReadyResponse;

export const zAppSearchData = z.object({
    body: z.never().optional(),
    path: z.never().optional(),
    query: z.object({
        query: z.string().min(1),
        page: z.number().int().gte(1).optional().default(1),
        page_size: z.number().int().gte(1).optional().default(30)
    })
});

/**
 * Search results.
 */
export const zAppSearchResponse = zQueryResult;

export const zAppDownloadUrlData = z.object({
    body: z.never().optional(),
    path: z.never().optional(),
    query: z.object({
        file_id: z.number().int().gte(1),
        valid_period: z.number().int().optional()
    })
});

/**
 * Download URL generated.
 */
export const zAppDownloadUrlResponse = zDownloadUrlResponse;

export const zCreateTokenData = z.object({
    body: zTokenRequest,
    path: z.never().optional(),
    query: z.never().optional()
});

/**
 * Token string.
 */
export const zCreateTokenResponse = z.string();

export const zRemoteSearchData = z.object({
    body: z.never().optional(),
    path: z.never().optional(),
    query: z.object({
        query: z.string().min(1),
        type: z.string().optional().default('all'),
        page_id: z.number().int().gte(0).optional().default(0),
        query_filter: z.string().optional().default('all'),
        search_in_folder: z.number().int().optional(),
        updated_time_range: z.string().optional()
    })
});

/**
 * Upstream search results (proxied).
 */
export const zRemoteSearchResponse2 = zRemoteSearchResponse;

export const zLocalSearchData = z.object({
    body: z.never().optional(),
    path: z.never().optional(),
    query: z.object({
        query: z.string().min(1),
        page: z.number().int().gte(1).optional().default(1),
        page_size: z.number().int().gte(1).optional().default(20),
        type: z.string().optional().default('all'),
        parent_id: z.number().int().optional(),
        updated_after: z.number().int().optional(),
        updated_before: z.number().int().optional(),
        include_deleted: z.boolean().optional().default(false)
    })
});

/**
 * Local search results.
 */
export const zLocalSearchResponse = zQueryResult;

export const zDownloadUrlData = z.object({
    body: z.never().optional(),
    path: z.never().optional(),
    query: z.object({
        file_id: z.number().int().gte(1),
        valid_period: z.number().int().optional()
    })
});

/**
 * Download URL generated.
 */
export const zDownloadUrlResponse2 = zDownloadUrlResponse;

export const zCancelSyncData = z.object({
    body: z.never().optional(),
    path: z.never().optional(),
    query: z.never().optional()
});

/**
 * Cancel signal sent.
 */
export const zCancelSyncResponse = zMessageResponse;

export const zGetSyncProgressData = z.object({
    body: z.never().optional(),
    path: z.never().optional(),
    query: z.never().optional()
});

/**
 * Current sync progress state.
 */
export const zGetSyncProgressResponse = zSyncProgressState;

export const zStartSyncData = z.object({
    body: zSyncStartRequest,
    path: z.never().optional(),
    query: z.never().optional()
});

/**
 * Sync job accepted.
 */
export const zStartSyncResponse = zMessageResponse;
